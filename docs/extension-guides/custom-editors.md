# 自定义编辑器 API

自定义编辑器允许开发者创建完全定制化的可读写编辑器，它可以替代 VS Code 中标准的文本编辑器，编辑一些特殊类型的资源。比如说：
- 预览资产(assests)文件，如直接在 VS Code 中查看3D 模型着色器
- 创建 WYSIWYG 编辑器，如 Markdown 或者 XAML
- 为 CSV、JSON或 XML 提供其他视觉渲染
- 为二进制文件或文本文件提供完全定制化的编辑体验

本章我们将大致看下自定义编辑器的 API，并实现一个基本的自定义编辑器。我们还会看一眼自定义编辑器的两种类型以及他们的差别，你应该如何选择合适的编辑器。然后我们会走一遍基本的实现。

虽然自定义编辑器是个非常强力的新功能，但实现一个基本的自定义编辑器真没那么难！不过，如果你目前还在做 VS Code 上的第一个插件，你可能需要考虑一下等到自己足够熟悉 VS Code API 的基本内容之后，再深入到编辑器开发中来。自定义编辑器立足于非常多的 VS Code 概念之上——包括 [webviews] 和 [文本文档] —— 所以如果你同时在本章接受这些概念的话，压力就会有些大了。

## 链接

[自定义编辑器 示例]()

#### VS Code API 用法

- [`window.registerCustomEditorProvider`]()
- [`CustomTextEditorProvider`]()

## 本 API 的基础

自定义编辑器是特定类型资源文件的编辑视图，它会替换 VS Code 中的标准文本编辑器展示的位置。自定义编辑器分为两部分：用户可交互的**视图**和你的插件与底层资源文件进行交互的**文档模型**。

自定义编辑器的视图侧是通过 [webviews] 实现的，所以你可以通过标准的 HTML、CSS 和 JavaScript 构建用户体验。Webview 是不能直接访问 VS Code API 的，但是它可以通过插件进行双向通信。看看我们的 [webview 文档]()，获取关于 webview 的最佳实践。

自定义编辑器的另外一部分是文档模型。这个模型是你的插件如何理解源（文件）以及如何相互工作的抽象。`CustomTextEditorProvider` 使用标准的 VS Code [TextDocument]，它的文档模型和文件的所有变化都会被表达为 VS Code 中的标准文本编辑 API。`CustomReadonlyEditorProvider` 和 `CustomEditorProvider` 则需要你自己提供文档模型，所以你就拥有了非文本格式的文档编辑能力。

自定义编辑器对应的每个资源文件可能各需要一个文档模型，但有的时候多个编辑器实例（视图）可能会共用一个文档模型。比如，你可以想象一下你打开的文件包含了一个`CustomTextEditorProvider`，然后你运行了**视图：拆分编辑器**命令，这样一来，虽然`TextDocument`只有一个，因为另外一个视图中的内容只是源文件的一个副本，但是现在这个资源文件产生了两个 webview 视图。

## 自定义文本编辑器

## 自定义编辑器

## 下一步